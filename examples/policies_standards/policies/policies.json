[
    {
        "policy_type": "iam",
        "cloud_type": "aws",
        "name": "[Demo-AXA]lombac Show all INACTIVE identities and their allowed actions over the last specified 90 days.",
        "severity": "high",
        "labels": ["Compliant"],
        "policy_subtype": ["permissions"],
        "rule_name": "[Demo-AXA_rule][compliant] IAM'",
        "rule_type": "IAM",
        "compliance_standard": "[compliant]AXA_Public_Cloud_AWS_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-10] App Service app slots that use Java should use a specified 'Java version'",
        "RQL": "config from iam where action.lastaccess.days > 90 AND dest.cloud.type = 'AWS'"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-10] App Service app slots that use Java should use a specified 'Java version'",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-10] App Service app slots that use Java should use a specified 'Java version'",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-10] App Service app slots that use Java should use a specified 'Java version'",
        "RQL": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service-deployment-slots' and json.rule = (properties.siteConfig.linuxFxVersion contains JAVA or properties.siteConfig.linuxFxVersion contains Java or properties.siteConfig.linuxFxVersion contains java) and properties.siteConfig.linuxFxVersion contains 11"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-18] App Service apps should not have CORS configured to allow every resource to access your apps",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-18] App Service apps should not have CORS configured to allow every resource to access your apps",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-18] App Service apps should not have CORS configured to allow every resource to access your apps",
        "RQL": "config from cloud.resource where api.name = 'azure-app-service' AND json.rule = config.cors.allowedOrigins[*] does not equal \"*\""
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-25] App Service apps that use PHP should use a specified 'PHP version'",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-25] App Service apps that use PHP should use a specified 'PHP version'",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-25] App Service apps that use PHP should use a specified 'PHP version'",
        "RQL": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = '(config.linuxFxVersion contains PHP or config.linuxFxVersion contains php) and config.linuxFxVersion contains 8.1'"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-37] App Service apps should only be accessible over HTTPS",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-37] App Service apps should only be accessible over HTTPS",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-37] App Service apps should only be accessible over HTTPS",
        "RQL": "config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-app-service' and json.rule = properties.httpsOnly is true"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-40] App Service app slots should only be accessible over HTTPS",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-40] App Service app slots should only be accessible over HTTPS",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-40] App Service app slots should only be accessible over HTTPS",
        "RQL": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service-deployment-slots' AND json.rule = properties.httpsOnly is true"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-47] App Service apps should have remote debugging turned off off in pre-roduction and production environment",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-47] App Service apps should have remote debugging turned off off in pre-roduction and production environment",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-47] App Service apps should have remote debugging turned off in pre-roduction and production environment",
        "RQL": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = (tags.global-env is member of (prd,Prd)) and (tags.global-env is member of (ppd,Ppd, Pre-production)) and config.remoteDebuggingEnabled is false or config.remoteDebuggingEnabled does not exist"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-54] App Service Environment should use the minimum 1.2 TLS version",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-54] App Service Environment should use the minimum 1.2 TLS version",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-54] App Service Environment should use the minimum 1.2 TLS version",
        "RQL": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service-environment' AND json.rule = properties.clusterSettings[*].name does not contain \"DisableTls1.0\" and  (properties.clusterSettings[*].value any start with \"1.2\" or properties.clusterSettings[*].value any start with \"1.3\")"
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-58] App Service Environment should have internal encryption enabled",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-58] App Service Environment should have internal encryption enabled",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-58] App Service Environment should have internal encryption enabled",
        "RQL": "config from cloud.resource where api.name = 'azure-app-service-environment' AND json.rule = properties.clusterSettings[*].name contains \"InternalEncryption\" and properties.clusterSettings[*].value equals \"true\" "
    },
    {
        "policy_type": "config",
        "cloud_type": "aws",
        "name": "[Demo-AXA][compliant][AZ-APS-60] App Service Apps should use the minimum 1.2 TLS version",
        "severity": "informational",
        "labels": ["Compliant"],
        "policy_subtype": ["run"],
        "rule_name": "[Demo-AXA_rule][compliant][AZ-APS-60] App Service Apps should use the minimum 1.2 TLS version",
        "rule_type": "Config",
        "compliance_standard": "[compliant]AXA_Public_Cloud_Azure_Security_Benchmark",
        "compliance_requirement": "App Service",
        "compliance_section": "[compliant][AZ-APS-60] App Service Apps should use the minimum 1.2 TLS version",
        "RQL": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule =config.minTlsVersion equals \"1.2\" or config.minTlsVersion equals \"1.3\""
    }
]